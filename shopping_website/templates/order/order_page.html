{% extends "base.html" %}

{% block title %}我要下單 - 智慧工廠下單系統{% endblock %}

{% block content %}
<h2>我要下單</h2>
<p class="text-muted">
  選擇本次要生產的產品與數量，下一步將進入製程規劃頁面，設定標準或客製流程。
</p>

{% if error_message %}
  <div class="alert alert-error">
    {{ error_message }}
  </div>
{% endif %}

<form method="post" id="order-form">
  <table>
    <thead>
      <tr>
        <th>產品名稱</th>
        <th>說明</th>
        <th class="text-right">單價</th>
        <th class="text-right">庫存</th>
        <th class="text-right">本次下單數量</th>
      </tr>
    </thead>
    <tbody>
      {% for p in products %}
      <tr>
        <td>{{ p.name }}</td>
        <td>{{ p.description }}</td>
        <td class="text-right">{{ p.base_price }}</td>
        <td class="text-right">{{ p.stock }}</td>
        <td class="text-right">
          <input
            type="number"
            class="order-qty-input"
            data-product-name="{{ p.name }}"
            min="0"
            max="{{ p.stock }}"
            name="qty_{{ p.id }}"
            value="0"
          >
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- JS 用來即時顯示合計數量 / 提醒 -->
  <div class="card mt-2" id="order-summary-card">
    <h3>本次下單摘要</h3>
    <p class="text-muted" id="order-summary-text">
      目前尚未選擇任何產品。
    </p>
  </div>

  <div class="mt-2 text-right">
    <button type="submit" class="btn">
      前往製程規劃
    </button>
  </div>
</form>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/order_page.js') }}"></script>
{% endblock %}



