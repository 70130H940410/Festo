{% extends "base.html" %}

{% block title %}製程規劃 - 智慧工廠下單系統{% endblock %}

{% block content %}
<h2>製程規劃</h2>
<p class="text-muted">
  以下是本次訂單的產品摘要與預設的標準製程流程。之後可以再擴充為可拖曳、客製每個步驟。
</p>

<!-- 訂單摘要 -->
<div class="card">
  <h3>本次下單產品摘要</h3>
  {% if order_items_summary %}
    <table>
      <thead>
        <tr>
          <th>產品名稱</th>
          <th class="text-right">數量</th>
        </tr>
      </thead>
      <tbody>
        {% for item in order_items_summary %}
        <tr>
          <td>{{ item.name }}</td>
          <td class="text-right">{{ item.quantity }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted">
      目前沒有從下單頁帶過來的產品資料，以下以示意資料顯示。
    </p>
  {% endif %}
</div>

<!-- 標準製程流程（目前以示意資料呈現） -->
<div class="card">
  <h3>標準製程流程（示意）</h3>
  <p class="text-muted">
    目前先以固定流程顯示，未來可以讓管理者在「製程模板管理」頁面調整步驟與預估時間。
  </p>

  <table>
    <thead>
      <tr>
        <th style="width: 80px;">順序</th>
        <th>步驟名稱</th>
        <th class="text-right" style="width: 140px;">預估時間（秒）</th>
      </tr>
    </thead>
    <tbody>
      {% for step in standard_steps %}
      <tr>
        <td>{{ step.step_order }}</td>
        <td>{{ step.step_name }}</td>
        <td class="text-right">{{ step.estimated_time_sec }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- 下一步操作 -->
<div class="card">
  <h3>下一步要做什麼？</h3>
  <p class="text-muted">
    Demo 版本中，點擊「前往工廠運作模擬」即可查看類似 Uber Eats 的產線模擬畫面。之後可以在這裡加入：
  </p>
  <ul class="text-muted">
    <li>調整流程順序（例如拖曳步驟上下移動）</li>
    <li>新增客製步驟（如額外測試、貼標）</li>
    <li>按「送出製程」時，真正寫入 orders / order_process_steps 資料表</li>
  </ul>

  <div class="mt-2 text-right">
    <a class="btn btn-secondary" href="{{ url_for('order.order_page') }}">
      返回修改商品數量
    </a>
    <a class="btn" href="{{ url_for('factory.simulate') }}">
      前往工廠運作模擬（Demo）
    </a>
  </div>
</div>
{% endblock %}

{% block scripts %}
  {# 之後如果要做拖曳排序 / 客製流程，可以在這裡引入 process_plan.js #}
  {# <script src="{{ url_for('static', filename='js/process_plan.js') }}"></script> #}
{% endblock %}



