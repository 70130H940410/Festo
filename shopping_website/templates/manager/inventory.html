{% extends "base.html" %}
{% block title %}庫存管理{% endblock %}

{% block content %}
<h2>庫存管理</h2>
<p class="text-muted">直接管理 product DB 的 products.stock。</p>

{% if error_message %}
  <div class="alert alert-error">{{ error_message }}</div>
{% endif %}
{% if success_message %}
  <div class="alert alert-success">{{ success_message }}</div>
{% endif %}

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>商品名稱</th>
      <th>單價</th>
      <th>目前庫存</th>
      <th>修改庫存</th>
    </tr>
  </thead>
  <tbody>
    {% if products and products|length > 0 %}
      {% for p in products %}
        <tr>
          <td>{{ p["id"] }}</td>
          <td>{{ p["name"] }}</td>
          <td>{{ p["base_price"] }}</td>
          <td>{{ p["stock"] }}</td>
          <td>
            <form method="post" style="display:flex; gap:8px; align-items:center;">
              <input type="hidden" name="product_id" value="{{ p['id'] }}">
              <input type="number" name="new_stock" min="0" value="{{ p['stock'] }}">
              <button type="submit">儲存</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    {% else %}
      <tr>
        <td colspan="5" class="text-center text-muted">products 沒有資料</td>
      </tr>
    {% endif %}
  </tbody>
</table>
{% endblock %}

